{"name":"Node-shoal","tagline":"A modern upstart replacement. Manage processes using centralized JSON configurations","body":"Shoal\r\n==========\r\n\r\n[![Build Status](https://travis-ci.org/dominiek/node-shoal.png?branch=master)](https://travis-ci.org/dominiek/node-shoal)\r\n\r\nShoal allows you to group and run multiple processes. Shoal manages these processes and exposes controls and status information via a HTTP JSON API. Aside from the JSON interface there is a Web user interface and a CLI.\r\n\r\nUse-cases:\r\n\r\n* Centralize process/worker configuration using a single JSON config file (Avoid hundreds of upstart scripts)\r\n* Use a CLI and Web UI to monitor and control a large number of process/worker instances\r\n* Simplifying process/worker management for developers (e.g. local installs of ETL's)\r\n* Smart deployments: Automatically stop workers that have been removed from configuration, and start instances that were added\r\n* Centrally control logging, environment and restart behavior of processes\r\n\r\n### Status\r\n\r\nThis project is still early stage. We do not recommend using this in production unless a proper security audit has been done. Current use should be for development environments only.\r\n\r\n### Security\r\n\r\nBy default, the Shoal Manager (`shoald`) binds to `127.0.0.1` and allows execution of commands sent to it. This is something to be taken into consideration when running outside of sandboxed environments. No security features are supplied with Shoal currently so environment-specific security mechanisms should be implemented by yourself.\r\n\r\n## Install\r\n\r\n```\r\nnpm install shoal\r\n```\r\n\r\n## Usage\r\n\r\nIn order to deploy and monitor processes with one of the user interfaces, you need to run the Shoal Manager. This is done by executing the `shoald` command that's included with the NPM module.\r\n\r\nBy default, the Shoal Manager listens for commands on port *54047* and also binds the Admin UI on port *54047*:\r\n\r\n```\r\n$ shoald\r\nShoal Manager running on http://127.0.0.1:54047\r\nShoal Admin UI running on http://127.0.0.1:54048\r\n```\r\n\r\nHere are some CLI options that can be given to `shoald`:\r\n\r\n```\r\n$ shoald --help\r\n  Usage: shoald [options]\r\n\r\n  Options:\r\n\r\n    -h, --help                     output usage information\r\n    -V, --version                  output the version number\r\n    -p, --port <port>              Port to bind on (Default: 54047)\r\n    -b, --bind <host>              Host to bind on (Default: 127.0.0.1)\r\n    -ap, --admin-port <port>       Port to bind Admin UI on (Default: 54048)\r\n    -ab, --admin-bind <host>       Host to bind Admin UI on (Default: 127.0.0.1)\r\n    -ah, --admin-html-file <path>  Path to HTML file to customize Admin UI\r\n    --disable-ui                   Disable Admin UI\r\n    --quiet                        Don't show Shoal info\r\n    --verbose                      More verbose output\r\n```\r\n\r\nOnce the Shoal Manager is running process configuration can be deployed with the `shoal` command.\r\n\r\n```\r\n$ shoal deploy examples/ping.json\r\n\r\nNew processes deployed\r\n\r\n$ shoal status\r\n\r\nPing Localhost   [ 2 RUNNING ] \r\nPing 127.0.0.1   [ 1 RUNNING ] \r\nPing 127.0.0.1   [ 1 RUNNING ] \r\nPing Google      [  STOPPED  ] \r\n\r\n```\r\n\r\n## Configuration \r\n\r\nThe Shoal Manager takes a JSON configuration that allows us to specify which processes should be run and how they should be executed. In Shoal, a *process* is a definition of a command that should be daemonized. One process can have many *instances* that all perform the same job.\r\n\r\nHere's an example configuration:\r\n\r\n```json\r\n{\r\n  \"env\": {\r\n    \"NODE_ENV\": \"staging\"\r\n  },\r\n  \"killTimeoutMs\": 30000,\r\n  \"logRoot\": \"/var/log\",\r\n  \"processes\": [\r\n    {\r\n      \"name\": \"Cassandra Worker\",\r\n      \"cmd\": \"node\",\r\n      \"args\": [\"script/worker.js\", \"cassandra\"],\r\n      \"env\": {\r\n        \"NAME\": \"$processName\",\r\n      },\r\n      \"instances\": 8,\r\n      \"autoRestart\": true,\r\n      \"autoRestartTimeoutMs\": 3000\r\n    },\r\n    {\r\n      \"name\": \"Some Daemon\",\r\n      \"cmd\": \"somed\",\r\n      \"args\": [\"-f\"],\r\n      \"killTimeoutMs\": 1000,\r\n      \"logRoot\": \"~/log\",\r\n      \"outFile\": \"somed.log\",\r\n      \"errFile\": \"somed.error\",\r\n      \"instances\": 0\r\n    }\r\n  ]\r\n}\r\n```\r\nEach process in the `processes` array takes the following required parameters:\r\n\r\n|Parameter    |Description                                |\r\n|-------------|-------------------------------------------|\r\n|name         |Name of the process/worker|\r\n|cmd          |Unix command to be executed without parameters (can be absolute path too)|\r\n|args         |Array of arguments to be given to the unix command|\r\n|instances    |The number of instances of this process that should be run. Can be 0 for inactive process definitions|\r\n\r\nThe following options can be given either in the top-level JSON or in the indvidual process definitions (overrides global settings):\r\n\r\n|Option                   |Defaults |Description                                |\r\n|-------------------------|---------|--------------------------------------------|\r\n|env                      |{}       |Hash with environment variables that should be used. See below for available Macros|\r\n|killTimeoutMs            |         |Number of miliseconds after which a unresponsive process instance (not responding to SIGHUP) should be send a SIGKILL|\r\n|autoRestart              |false    |Automatically restart a process instance after exit|\r\n|autoRestartTimeoutMs     |1000     |Number of miliseconds to wait until restarting the process instance|\r\n|logRoot                  |         |Specify output logging directory. When specified each process will have stdout and stderr send to respective `process-name.out` and `process-name.err` files|\r\n|outFile                  |$processShortName.out|Override default stdout output file. Requires logRoot to be set|\r\n|errFile                  |$processShortName.err|Override default stderr output file. Requires logRoot to be set|\r\n|quiet                    |false    |Don't show any output from shoal manager server or admin UI|\r\n\r\n### Environment Macros\r\n\r\nWhen configuring custom environment variables for a process or configuration, you can use the following internal variables/macros:\r\n\r\n|Variable         |Description                     |\r\n|-----------------|--------------------------------|\r\n|$processName     |Configured name of the process|\r\n|$processShortName|A dashed and lowercase conversion of the processName (e.g. My Worker => 'my-worker')|\r\n|$processId       |A unique ID of the process based on the name, cmd and env|\r\n|$shoalCwd        |The working directory path that the Shoal Manager is running in|\r\n|$shoalVersion    |Shoal version|\r\n|$logRoot         |The configured log root for the process|\r\n\r\n## Future\r\n\r\n* Improve default security features\r\n* Allow Shoal to dynamically control the number of instances per process definition based on the 'business' of the running instances\r\n\r\n## TODO\r\n\r\n* Allow Shoal Manager to be started with a starting configuration\r\n* Update documentation\r\n* Setup OSS site\r\n\r\n## License\r\n\r\n(The MIT License)\r\n\r\nCopyright (c) 2014 Dominiek ter Heide <dominiek@bottlenose.com>\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy\r\nof this software and associated documentation files (the \"Software\"), to deal\r\nin the Software without restriction, including without limitation the rights\r\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\ncopies of the Software, and to permit persons to whom the Software is\r\nfurnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in\r\nall copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\nTHE SOFTWARE.\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}